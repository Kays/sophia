#!/usr/bin/env perl

use strict;
use warnings;
use FindBin qw($Bin);
use Getopt::Long;

my $force = 0;
GetOptions(
    'force' => \$force,
);

if ( !$force && -e "$Bin/../etc/sophia.conf" ) {
    print "sophia.conf file already exists.\n";
    exit;
}

if ( !$force && -e "$Bin/../etc/sophia.conf.example" ) {
    print "Check sophia.conf.example in etc directory.\n";
    exit;
}

unless ( -d "$Bin/../etc" ) {
    mkdir "$Bin/../etc", 0760 or die "Cannot create etc directory: $!\n";
}

open  CONFIG, "> $Bin/../etc/sophia.conf.example";
print CONFIG '# indicates a comment line' . "\n\n";
print CONFIG 'nick = "sophia"' . "\n";
print CONFIG 'username = "sophia"' . "\n";
print CONFIG 'realname = "Sophia"' . "\n";
print CONFIG 'password = ""             # used with NickServ. Leave blank if it doesn\'t apply.' . "\n";
print CONFIG 'usermode = "+i"' . "\n";
print CONFIG "\n\n";
print CONFIG 'server = "irc.domain.net"' . "\n";
print CONFIG 'port = "6667"' . "\n";
print CONFIG "\n\n";
print CONFIG 'owner_name = "owner"' . "\n";
print CONFIG 'owner_host = "*!*@domain.net"' . "\n";
print CONFIG "\n\n";
print CONFIG '# this is the trigger for commands' . "\n";
print CONFIG 'trigger = "!"' . "\n";
print CONFIG "\n\n";
print CONFIG '# join the following channels' . "\n";
print CONFIG 'channel = "#sophia"' . "\n";
print CONFIG 'channel = "#sophia-dev"' . "\n";
close CONFIG;

printf "Successfully generated example config.\n";
exit;
